package converter

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestCanConvertPolygonTag(test *testing.T) {
	polygonTag := `<polygon xmlns="http://www.w3.org/2000/svg" points="698.163,356.784 684.777,361.955 673.801,397.971 659.1,439.346 667.969,540.967 667.886,545.193 630.317,582.497 526.88,591.632 518.729,606.871 442,608.984 424.176,594.141 371.715,590.391 282.423,555.724 276.387,555.605 267.565,543.657 229.697,534.759 213.875,510.294 189.399,495.923 140.152,482.275 132.567,468.841 128.627,454.271 119.419,446.543 90.47,429.367 80.803,398.984 75.809,391.941 86.806,370.118 77.741,339.747 66.439,331.07 63.599,321.958 47.931,289.644 8.581,248.714 8.705,242.376 9.014,226.682 9.168,218.835 1.068,208.562 6.252,198.247 24.102,181.086 31.345,181.229 39.795,181.395 63.113,162.531 69.978,151.193 75.814,130.776 68.382,109.496 78.256,68.024 113.136,75.353 173.145,33.056 192.225,14.712 204.44,7.707 231.1,3.099 251.659,1.692 259.524,0.94 275.536,15.748 299.077,16.211 331.086,15.936 343.129,17.682 358.706,24.027 431.067,29.073 443.47,43.206 484.411,49.446 512.221,78.374 524.889,94.323 539.393,109.102 537.886,154.963 550.147,176.339 577.959,205.268 578.746,211.322 577.792,213.718 577.709,217.944 591.615,232.409 615.402,266.39 637.557,291.282 661.879,298.1 686.91,314.897 698.269,351.351 " 
						id="polygon13" 
						style="fill:#f4e2ba"/>`

	path := Convert(polygonTag)

	expectedPath := getExpectedPathFromPolygon()
	assert.Equal(test, expectedPath, path)
}

func TestCanConvertPolylineTag(test *testing.T) {
	polylineTag := `<polyline style="fill:none" id="polyline83" points="63.599,321.958 72.129,318.198 120.935,292.891 " i:knockout="Off"/>`

	path := Convert(polylineTag)

	expectedPath := getExpectedPathFromPolyline()
	assert.Equal(test, expectedPath, path)
}

func TestCanConvertPointsAttribut(test *testing.T) {
	polygonTag := `<polygon xmlns="http://www.w3.org/2000/svg" points="698.163,356.784 684.777,361.955 673.801,397.971 659.1,439.346 667.969,540.967 667.886,545.193 630.317,582.497 526.88,591.632 518.729,606.871 442,608.984 424.176,594.141 371.715,590.391 282.423,555.724 276.387,555.605 267.565,543.657 229.697,534.759 213.875,510.294 189.399,495.923 140.152,482.275 132.567,468.841 128.627,454.271 119.419,446.543 90.47,429.367 80.803,398.984 75.809,391.941 86.806,370.118 77.741,339.747 66.439,331.07 63.599,321.958 47.931,289.644 8.581,248.714 8.705,242.376 9.014,226.682 9.168,218.835 1.068,208.562 6.252,198.247 24.102,181.086 31.345,181.229 39.795,181.395 63.113,162.531 69.978,151.193 75.814,130.776 68.382,109.496 78.256,68.024 113.136,75.353 173.145,33.056 192.225,14.712 204.44,7.707 231.1,3.099 251.659,1.692 259.524,0.94 275.536,15.748 299.077,16.211 331.086,15.936 343.129,17.682 358.706,24.027 431.067,29.073 443.47,43.206 484.411,49.446 512.221,78.374 524.889,94.323 539.393,109.102 537.886,154.963 550.147,176.339 577.959,205.268 578.746,211.322 577.792,213.718 577.709,217.944 591.615,232.409 615.402,266.39 637.557,291.282 661.879,298.1 686.91,314.897 698.269,351.351 " 
						id="polygon13" 
						style="fill:#f4e2ba"/>`

	path := Convert(polygonTag)

	expectedPath := getExpectedPathFromPolygon()
	assert.Equal(test, expectedPath, path)
}

func TestCanAddMElementInDAttribut(test *testing.T) {
	polygonTag := `<polygon xmlns="http://www.w3.org/2000/svg" points="698.163,356.784 684.777,361.955 673.801,397.971 659.1,439.346 667.969,540.967 667.886,545.193 630.317,582.497 526.88,591.632 518.729,606.871 442,608.984 424.176,594.141 371.715,590.391 282.423,555.724 276.387,555.605 267.565,543.657 229.697,534.759 213.875,510.294 189.399,495.923 140.152,482.275 132.567,468.841 128.627,454.271 119.419,446.543 90.47,429.367 80.803,398.984 75.809,391.941 86.806,370.118 77.741,339.747 66.439,331.07 63.599,321.958 47.931,289.644 8.581,248.714 8.705,242.376 9.014,226.682 9.168,218.835 1.068,208.562 6.252,198.247 24.102,181.086 31.345,181.229 39.795,181.395 63.113,162.531 69.978,151.193 75.814,130.776 68.382,109.496 78.256,68.024 113.136,75.353 173.145,33.056 192.225,14.712 204.44,7.707 231.1,3.099 251.659,1.692 259.524,0.94 275.536,15.748 299.077,16.211 331.086,15.936 343.129,17.682 358.706,24.027 431.067,29.073 443.47,43.206 484.411,49.446 512.221,78.374 524.889,94.323 539.393,109.102 537.886,154.963 550.147,176.339 577.959,205.268 578.746,211.322 577.792,213.718 577.709,217.944 591.615,232.409 615.402,266.39 637.557,291.282 661.879,298.1 686.91,314.897 698.269,351.351 " 
						id="polygon13" 
						style="fill:#f4e2ba"/>`

	path := Convert(polygonTag)

	expectedPath := getExpectedPathFromPolygon()
	assert.Equal(test, expectedPath, path)
}

func TestCanAddZElementInDAttribut(test *testing.T) {
	polygonTag := `<polygon xmlns="http://www.w3.org/2000/svg" points="698.163,356.784 684.777,361.955 673.801,397.971 659.1,439.346 667.969,540.967 667.886,545.193 630.317,582.497 526.88,591.632 518.729,606.871 442,608.984 424.176,594.141 371.715,590.391 282.423,555.724 276.387,555.605 267.565,543.657 229.697,534.759 213.875,510.294 189.399,495.923 140.152,482.275 132.567,468.841 128.627,454.271 119.419,446.543 90.47,429.367 80.803,398.984 75.809,391.941 86.806,370.118 77.741,339.747 66.439,331.07 63.599,321.958 47.931,289.644 8.581,248.714 8.705,242.376 9.014,226.682 9.168,218.835 1.068,208.562 6.252,198.247 24.102,181.086 31.345,181.229 39.795,181.395 63.113,162.531 69.978,151.193 75.814,130.776 68.382,109.496 78.256,68.024 113.136,75.353 173.145,33.056 192.225,14.712 204.44,7.707 231.1,3.099 251.659,1.692 259.524,0.94 275.536,15.748 299.077,16.211 331.086,15.936 343.129,17.682 358.706,24.027 431.067,29.073 443.47,43.206 484.411,49.446 512.221,78.374 524.889,94.323 539.393,109.102 537.886,154.963 550.147,176.339 577.959,205.268 578.746,211.322 577.792,213.718 577.709,217.944 591.615,232.409 615.402,266.39 637.557,291.282 661.879,298.1 686.91,314.897 698.269,351.351 " 
						id="polygon13" 
						style="fill:#f4e2ba"/>`

	path := Convert(polygonTag)

	expectedPath := getExpectedPathFromPolygon()
	assert.Equal(test, expectedPath, path)
}

func getExpectedPathFromPolygon() string {
	return `<path xmlns="http://www.w3.org/2000/svg" d="M698.163,356.784 L684.777,361.955 673.801,397.971 659.1,439.346 667.969,540.967 667.886,545.193 630.317,582.497 526.88,591.632 518.729,606.871 442,608.984 424.176,594.141 371.715,590.391 282.423,555.724 276.387,555.605 267.565,543.657 229.697,534.759 213.875,510.294 189.399,495.923 140.152,482.275 132.567,468.841 128.627,454.271 119.419,446.543 90.47,429.367 80.803,398.984 75.809,391.941 86.806,370.118 77.741,339.747 66.439,331.07 63.599,321.958 47.931,289.644 8.581,248.714 8.705,242.376 9.014,226.682 9.168,218.835 1.068,208.562 6.252,198.247 24.102,181.086 31.345,181.229 39.795,181.395 63.113,162.531 69.978,151.193 75.814,130.776 68.382,109.496 78.256,68.024 113.136,75.353 173.145,33.056 192.225,14.712 204.44,7.707 231.1,3.099 251.659,1.692 259.524,0.94 275.536,15.748 299.077,16.211 331.086,15.936 343.129,17.682 358.706,24.027 431.067,29.073 443.47,43.206 484.411,49.446 512.221,78.374 524.889,94.323 539.393,109.102 537.886,154.963 550.147,176.339 577.959,205.268 578.746,211.322 577.792,213.718 577.709,217.944 591.615,232.409 615.402,266.39 637.557,291.282 661.879,298.1 686.91,314.897 698.269,351.351 Z" id="polygon13" style="fill:#f4e2ba"/>`
}

func getExpectedPathFromPolyline() string {
	return `<path style="fill:none" id="polyline83" d="M63.599,321.958 L72.129,318.198 120.935,292.891 " i:knockout="Off"/>`
}
